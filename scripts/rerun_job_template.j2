#!/usr/bin/env bash
# Rerun PBS array jobs by global job ID
# Auto-generated - DO NOT EDIT DIRECTLY
#
# Usage: ./rerun_job.sh <method> <job_ids>
#
# job_ids format (passed directly to qsub -J):
#   5           Single job
#   1,3,5       Specific jobs (comma-separated)
#   1-10        Range
#   1-10,15,20  Mix of ranges and singles
#
# Examples:
#   ./rerun_job.sh QSA 42
#   ./rerun_job.sh Manifold 1-5
#   ./rerun_job.sh InteriorPoint 1,5,10-15

set -euo pipefail

[[ $# -eq 2 ]] || { echo "Usage: $0 <method> <job_ids>" >&2; exit 1; }

METHOD="$1"
JOB_IDS="$2"

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PARAMS_FILE="$SCRIPT_DIR/${METHOD}_parameters.txt"
PBS_SCRIPT="$SCRIPT_DIR/pbs_scripts/run_${METHOD,,}_sweep.pbs"

[[ -f "$PARAMS_FILE" ]] || { echo "ERROR: $PARAMS_FILE not found" >&2; exit 1; }
[[ -f "$PBS_SCRIPT" ]] || { echo "ERROR: $PBS_SCRIPT not found" >&2; exit 1; }

echo "Submitting: $METHOD jobs with indices $JOB_IDS"
qsub -J "$JOB_IDS" "$PBS_SCRIPT"
